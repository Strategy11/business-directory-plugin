jQuery(function($){function makeProgress(){inProgress&&$.get(ajaxurl,{action:"wpbdp-manual-upgrade"},function(response){var currentText=$progressArea.val(),newLine=(response.ok?"*":"!")+" "+response.status;$progressArea.val(currentText+newLine+"\n"),$progressArea.scrollTop($progressArea[0].scrollHeight-$progressArea.height()),response.done?$("div.step-upgrade").fadeOut(function(){$("div.step-done").fadeIn()}):makeProgress()},"json")}var $startButton=$(".wpbdp-admin-page-manual-upgrade a.start-upgrade"),$pauseButton=$(".wpbdp-admin-page-manual-upgrade a.pause-upgrade"),$progressArea=$("textarea#manual-upgrade-progress"),inProgress=!1;$startButton.click(function(e){e.preventDefault(),inProgress||(inProgress=!0,makeProgress())}),$pauseButton.click(function(e){e.preventDefault(),inProgress=!1}),$("#wpbdp-manual-upgrade-18_0-config #add-fee-form form#wpbdp-fee-form").submit(function(e){e.preventDefault();var data,e=$(this).data("levelId");e&&(data=$(this).serialize(),$('input[name="level['+e+'][details]"]').val(data),$('table.new-fee-summary[data-level-id="'+e+'"] td[data-attr="fee_label"]').html($(this).find('input[name="fee[label]"]').val()),$('table.new-fee-summary[data-level-id="'+e+'"] td[data-attr="fee_amount"]').html($(this).find('input[name="fee[amount]"]').val()),$('table.new-fee-summary[data-level-id="'+e+'"] td[data-attr="fee_duration"]').html($(this).find('input[name="fee[days]"]').val()),$('table.new-fee-summary[data-level-id="'+e+'"] td[data-attr="fee_images"]').html($(this).find('input[name="fee[images]"]').val())),$("#TB_closeWindowButton").click()}),$("#wpbdp-manual-upgrade-18_0-config select.level-migration").change(function(e){var $config,selection=$(this).find("option:selected"),$desc=$(this).siblings(".option-description");$(this).siblings(".option-configuration").hide(),selection.val()?($desc.html(selection.data("description")).show(),0<($config=$(this).siblings(".option-configuration").filter(".option-"+selection.val())).length&&$config.show(),"create"==selection.val()&&($("form#wpbdp-fee-form").get(0).reset(),$("form#wpbdp-fee-form").data("levelId",$(this).attr("data-level-id")),$config.find(".new-fee-summary tbody td").html("-"),tb_show($("#add-fee-form").attr("data-title"),"#TB_inline?inlineId=add-fee-form"),$("form#wpbdp-fee-form input:first").focus())):($desc.hide(),$(this).siblings(".option-configuration").hide())})});