function wpbdp_load_placeholder($v){var action=$v.attr("data-action"),post_id=$v.attr("data-post_id"),baseurl=$v.attr("data-baseurl");$v.load(ajaxurl,{action:action,post_id:post_id,baseurl:baseurl})}function wpbdpAddons(){function activateAddon(e){e.preventDefault(),installOrActivate(this,"wpbdp_activate_addon")}function installAddon(e){e.preventDefault(),installOrActivate(this,"wpbdp_install_addon")}function installOrActivate(clicked,action){jQuery(".wpbdp-addon-error").remove();var button=jQuery(clicked),plugin=button.attr("rel"),el=button.parent(),message=el.parent().find(".addon-status-label");button.addClass("wpbdp-loading-button"),jQuery.ajax({url:ajaxurl,type:"POST",async:!0,cache:!1,dataType:"json",data:{action:action,nonce:wpbdp_global.nonce,plugin:plugin},success:function(response){var error=extractErrorFromAddOnResponse(response);return error?void addonError(error,el,button):void afterAddonInstall(response,button,message,el)},error:function(){button.removeClass("wpbdp-loading-button")}})}function installAddonWithCreds(e){e.preventDefault();var proceed=jQuery(this),el=proceed.parent().parent(),plugin=proceed.attr("rel");proceed.addClass("wpbdp-loading-button"),jQuery.ajax({url:ajaxurl,type:"POST",async:!0,cache:!1,dataType:"json",data:{action:"wpbdp_install_addon",nonce:wpbdp_global.nonce,plugin:plugin,hostname:el.find("#hostname").val(),username:el.find("#username").val(),password:el.find("#password").val()},success:function(response){var error=extractErrorFromAddOnResponse(response);return error?void addonError(error,el,proceed):void afterAddonInstall(response,proceed,message,el)},error:function(){proceed.removeClass("wpbdp-loading-button")}})}function afterAddonInstall(response,button,message,el){button.css({opacity:"0"}),message.text("Active"),jQuery("#wpbdp-oneclick").hide(),jQuery("#wpbdp-addon-status").text(response).show(),jQuery("#wpbdp-upgrade-modal h2").hide(),jQuery("#wpbdp-upgrade-modal .wpbdp-lock-icon").addClass("wpbdp-lock-open-icon"),jQuery("#wpbdp-upgrade-modal .wpbdp-lock-icon use").attr("xlink:href","#wpbdp-lock-open-icon"),el.parent().removeClass("wpbdp-addon-not-installed wpbdp-addon-installed").addClass("wpbdp-addon-active"),button.removeClass("wpbdp-loading-button");var refreshPage=document.querySelectorAll(".wpbdp-admin-page-import, #wpbdp-admin-smtp, #wpbdp-welcome");refreshPage.length>0&&window.location.reload()}function extractErrorFromAddOnResponse(response){return"string"!=typeof response&&(("undefined"==typeof response.success||!response.success)&&(response.form&&jQuery(response.form).is("#message")?{message:jQuery(response.form).find("p").html()}:response))}function addonError(response,el,button){response.form?(jQuery(".wpbdp-inline-error").remove(),button.closest(".wpbdp-card").html(response.form).css({padding:5}).find("#upgrade").attr("rel",button.attr("rel")).on("click",installAddonWithCreds)):(el.append('<div class="wpbdp-addon-error wpbdp_error_style"><p><strong>'+response.message+"</strong></p></div>"),button.removeClass("wpbdp-loading-button"),jQuery(".wpbdp-addon-error").delay(4e3).fadeOut())}return{init:function(){jQuery(document).on("click",".wpbdp-install-addon",installAddon),jQuery(document).on("click",".wpbdp-activate-addon",activateAddon)}}}function wpbdpSelectSubnav(){var wpbdpMenu=jQuery("#toplevel_page_wpbdp_admin");jQuery(wpbdpMenu).removeClass("wp-not-current-submenu").addClass("wp-has-current-submenu wp-menu-open"),jQuery("#toplevel_page_wpbdp_admin a.wp-has-submenu").removeClass("wp-not-current-submenu").addClass("wp-has-current-submenu wp-menu-open")}var WPBDP_associations_fieldtypes={};!function($){var WPBDPAdmin_FormFields={$f_association:null,$f_fieldtype:null,init:function(){WPBDPAdmin_FormFields.$f_association=$("form#wpbdp-formfield-form select#field-association"),WPBDPAdmin_FormFields.$f_association.change(WPBDPAdmin_FormFields.onAssociationChange),WPBDPAdmin_FormFields.$f_fieldtype=$("form#wpbdp-formfield-form select#field-type"),WPBDPAdmin_FormFields.$f_fieldtype.change(WPBDPAdmin_FormFields.onFieldTypeChange),WPBDPAdmin_FormFields.$f_validator=$("form#wpbdp-formfield-form select#field-validator"),WPBDPAdmin_FormFields.$f_validator.change(WPBDPAdmin_FormFields.onFieldValidatorChange),$("#wpbdp-fieldsettings .iframe-confirm a").click(function(e){e.preventDefault(),$(this).hasClass("yes")?$(this).parents(".iframe-confirm").hide():($('#wpbdp-fieldsettings input[name="field[allow_iframes]"]').prop("checked",!1),$(this).parents(".iframe-confirm").hide())}),$('#wpbdp-fieldsettings input[name="field[allow_iframes]"]').change(function(){$(this).is(":checked")?$(".iframe-confirm").show():$(".iframe-confirm").hide()}),$('#wpbdp-formfield-form input[name="field[display_flags][]"][value="search"]').change(function(){$(".if-display-in-search").toggle($(this).is(":checked"))}),$("table.formfields tbody").sortable({placeholder:"wpbdp-draggable-highlight",handle:".wpbdp-drag-handle",axis:"y",cursor:"move",opacity:.9,update:function(event,ui){var sorted_items=[];$(this).find(".wpbdp-drag-handle").each(function(i,v){sorted_items.push($(v).attr("data-field-id"))}),sorted_items&&$.post(ajaxurl,{action:"wpbdp-formfields-reorder",order:sorted_items})}}),$('#wpbdp-formfield-form select[name="limit_categories"]').change(function(){var form=$(this).parents("form").find("#limit-categories-list");"1"===$(this).val()?form.removeClass("hidden"):form.addClass("hidden")})},onFieldTypeChange:function(){var $field_type=$(this).find("option:selected");if($field_type.length){var field_type=$field_type.val();$("select#field-validator").prop("disabled",!1),"url"==field_type?($("select#field-validator option").not('[value="url"]').prop("disabled",!0).prop("selected",!1),$('select#field-validator option[value="url"]').prop("selected",!0)):$("select#field-validator option").prop("disabled",!1),"social-twitter"==field_type&&$("select#field-validator").prop("disabled",!0);var request_data={action:"wpbdp-renderfieldsettings",association:WPBDPAdmin_FormFields.$f_association.find("option:selected").val(),field_type:field_type,field_id:$('#wpbdp-formfield-form input[name="field[id]"]').val()};$.post(ajaxurl,request_data,function(response){response.ok&&response.html?($("#wpbdp-fieldsettings-html").html(response.html),$("#wpbdp-fieldsettings").show()):($("#wpbdp-fieldsettings-html").empty(),$("#wpbdp-fieldsettings").hide())},"json"),WPBDPAdmin_FormFields.onFieldValidatorChange()}},onAssociationChange:function(){$f_fieldtype=WPBDPAdmin_FormFields.$f_fieldtype;var association=$(this).val(),valid_types=WPBDP_associations_fieldtypes[association],private_option=$("#wpbdp_private_field");$f_fieldtype.find("option").prop("disabled",!1),$f_fieldtype.find("option").each(function(i,v){$.inArray($(v).val(),valid_types)<0&&$(v).prop("disabled",!0)}),$f_fieldtype.change(),0<=["title","content","category"].indexOf(association)?(private_option.find("input").prop("disabled",!0),private_option.hide()):(private_option.find("input").prop("disabled",!1),private_option.show());var form=$(this).parents("form").find(".limit-categories");0<=["title","category"].indexOf(association)?form.addClass("hidden"):form.removeClass("hidden")},onFieldValidatorChange:function(){var $field_validator=$(this).find("option:selected"),field_type=WPBDPAdmin_FormFields.$f_fieldtype.find("option:selected").val();"textfield"===field_type||"textarea"===field_type?"word_number"===$field_validator.val()?($("#wpbdp_word_count").show(),$('select#field-validator option[value="word_number"]').prop("disabled",!1)):$("#wpbdp_word_count").hide():($("#wpbdp_word_count").hide(),$('select#field-validator option[value="word_number"]').prop("disabled",!0).prop("selected",!1))}};$(document).ready(function(){WPBDPAdmin_FormFields.init()})}(jQuery),jQuery(document).ready(function($){$(".wpbdp-admin-page-fees .wp-list-table.fees tbody").sortable({placeholder:"wpbdp-draggable-highlight",handle:".wpbdp-drag-handle",axis:"y",cursor:"move",opacity:.9,update:function(event,ui){var rel_rows=$(".free-fee-related-tr").remove();$("tr.free-fee").after(rel_rows);var sorted_items=[];$(this).find(".wpbdp-drag-handle").each(function(i,v){sorted_items.push($(v).attr("data-fee-id"))}),sorted_items&&$.post(ajaxurl,{action:"wpbdp-admin-fees-reorder",order:sorted_items})}}),$('select[name="fee_order[method]"], select[name="fee_order[order]"]').change(function(e){$.ajax({url:ajaxurl,data:$(this).parent("form").serialize(),dataType:"json",type:"POST",success:function(res){res.success&&location.reload()}})}),"custom"==$('select[name="fee_order[method]"]').val()&&$(".wpbdp-admin-page-fees .wp-list-table .wpbdp-drag-handle").show(),$(".wpbdp-ajax-placeholder").each(function(i,v){wpbdp_load_placeholder($(v))}),$("input#doaction, input#doaction2").click(function(e){var action_name="doaction"==$(this).attr("id")?"action":"action2",$selected_option=$('select[name="'+action_name+'"] option:selected'),action_val=$selected_option.val();if("listing"==action_val.split("-")[0]){var action=action_val.split("-")[1];if("sep0"!=action&&"sep1"!=action&&"sep2"!=action){var $checked_posts=$('input[name="post[]"]:checked'),uri=$selected_option.attr("data-uri");return $checked_posts.each(function(i,v){uri+="&post[]="+$(v).val()}),window.location.href=uri,!1}}return!0}),$('.wpbdp-admin.wpbdp-page-formfields-preview form input[type="submit"]').click(function(e){e.preventDefault(),alert("This form is just a preview. It doesn't work.")}),$("#wpbdp-admin-debug-info-page a.nav-tab").click(function(e){e.preventDefault(),$("#wpbdp-admin-debug-info-page a.nav-tab").not(this).removeClass("nav-tab-active");var $selected_tab=$(this);$selected_tab.addClass("nav-tab-active"),$(".wpbdp-debug-section").hide(),$('.wpbdp-debug-section[data-id="'+$(this).attr("href")+'"]').show()}),$("#wpbdp-admin-debug-info-page a.nav-tab").length>0&&$("#wpbdp-admin-debug-info-page a.nav-tab").get(0).click(),$(".wpbdp-page-admin-transactions .column-actions a.details-link").click(function(e){e.preventDefault();var $tr=$(this).parents("tr"),$details=$tr.find("div.more-details"),$tr_details=$tr.next("tr.more-details-row");return $tr_details.length>0?($tr_details.remove(),void $(this).text($(this).text().replace("-","+"))):($(this).text($(this).text().replace("+","-")),void $tr.after('<tr class="more-details-row"><td colspan="7">'+$details.html()+"</td></tr>").show())})});var WPBDP_Admin={};WPBDP_Admin.payments={},WPBDP_Admin.ProgressBar=function($item,settings){$item.empty(),$item.html('<div class="wpbdp-progress-bar"><span class="progress-text">0%</span><div class="progress-bar"><div class="progress-bar-outer"><div class="progress-bar-inner" style="width: 0%;"></div></div></div>'),this.$item=$item,this.$text=$item.find(".progress-text"),this.$bar=$item.find(".progress-bar"),this.set=function(completed,total){var pcg=Math.round(100*parseInt(completed)/parseInt(total));this.$text.text(pcg+"%"),this.$bar.find(".progress-bar-inner").attr("style","width: "+pcg+"%;")}},function($){WPBDP_Admin.dialog={};WPBDP_Admin.dialog}(jQuery),function($){var payments=WPBDP_Admin.payments;payments._initialize=function(){$("#BusinessDirectory_listinginfo a.payment-details-link").click(function(e){e.preventDefault(),payments.viewPaymentDetails($(this).attr("data-id"))}),0==$("#wpbdp-modal-dialog").length&&$("body").append($('<div id="wpbdp-modal-dialog"></div>'))},payments.viewPaymentDetails=function(id){$.get(ajaxurl,{action:"wpbdp-payment-details",id:id},function(res){res&&res.success&&(0==$("#wpbdp-modal-dialog").length&&$("body").append($('<div id="wpbdp-modal-dialog"></div>')),$("#wpbdp-modal-dialog").html(res.data.html),tb_show("","#TB_inline?inlineId=wpbdp-modal-dialog"),$("#TB_window").width($("#TB_ajaxContent").outerWidth()),$("#TB_window").height()>$("#TB_ajaxContent").outerHeight()&&$("#TB_ajaxContent").height($("#TB_window").height()),$("#wpbdp-modal-dialog").remove())},"json")},$(document).ready(function(){payments._initialize()})}(jQuery),function($){var s=WPBDP_Admin.settings={init:function(){$("#wpbdp-settings-quick-search-fields").on("change",":checkbox",function(){var $container=$("#wpbdp-settings-quick-search-fields"),text_fields=$container.data("text-fields"),selected=$container.find(":checkbox:checked").map(function(){return parseInt($(this).val())}).get(),show_warning=!1;if(selected.length>0&&text_fields.length>0)for(var i=0;i<text_fields.length;i++)if($.inArray(text_fields[i],selected)>-1){show_warning=!0;break}show_warning?$("#wpbdp-settings-quick-search-fields .text-fields-warning").fadeIn("fast"):$("#wpbdp-settings-quick-search-fields .text-fields-warning").fadeOut("fast")}),$("#wpbdp-settings-currency select").on("change",function(){"AED"===$(this).val()?$("#wpbdp-settings-currency .wpbdp-setting-description").show():$("#wpbdp-settings-currency .wpbdp-setting-description").hide()}),$("#wpbdp-settings-currency select").change()}};$(document).ready(function(){$("#wpbdp-admin-page-settings").length>0&&s.init()})}(jQuery),jQuery(function($){if(0!=$(".wpbdp-admin-page-uninstall").length){var $warnings=$("#wpbdp-uninstall-messages"),$confirm_button=$("#wpbdp-uninstall-proceed-btn"),$form=$("#wpbdp-uninstall-capture-form");$confirm_button.click(function(e){e.preventDefault(),$warnings.fadeOut("fast",function(){$form.fadeIn("fast")})}),$form.submit(function(){var $no_reason_error=$(".wpbdp-validation-error.no-reason").hide(),$no_text_error=$(".wpbdp-validation-error.no-reason-text").hide(),$reason_checked=$('input[name="uninstall[reason_id]"]:checked');if(0==$reason_checked.length)return $no_reason_error.show(),!1;if("0"==$reason_checked.val()){var $reason_text=$('textarea[name="uninstall[reason_text]"]'),reason_text=$.trim($reason_text.val());if($reason_text.removeClass("invalid"),!reason_text)return $no_text_error.show(),$reason_text.addClass("invalid"),!1}return!0}),$('form#wpbdp-uninstall-capture-form input[name="uninstall[reason_id]"]').change(function(e){var val=$(this).val();"0"==val?$("form#wpbdp-uninstall-capture-form .custom-reason").fadeIn():$("form#wpbdp-uninstall-capture-form .custom-reason").fadeOut("fast",function(){$(this).val("")})})}}),function($){$(document).ready(function(){0!=$("body.wp-admin.widgets-php").length&&$("body.wp-admin.widgets-php").on("change","input.wpbdp-toggle-images",function(){var checked=$(this).is(":checked");checked?$(this).parents(".widget").find(".thumbnail-width-config").fadeIn("fast"):$(this).parents(".widget").find(".thumbnail-width-config").fadeOut("fast")})})}(jQuery),function($){$(document).ready(function(){$("a.wpbdp-create-main-page-button").click(function(e){e.preventDefault();var $msg=$(this).parents("div.error");$.ajax({url:ajaxurl,data:{action:"wpbdp-create-main-page",_wpnonce:$(this).attr("data-nonce")},dataType:"json",success:function(res){res.success&&$msg.fadeOut("fast",function(){$(this).html("<p>"+res.message+"</p>"),$(this).removeClass("error"),$(this).addClass("updated"),$(this).fadeIn("fast")})}})})})}(jQuery),function($){$(function(){var dismissNotice=function($notice,notice_id,nonce){$.post(ajaxurl,{action:"wpbdp_dismiss_notification",id:notice_id,nonce:nonce},function(){$notice.fadeOut("fast",function(){$notice.remove()})})};$("#wpbody-content").on("click",".wpbdp-notice.dismissible > .notice-dismiss",function(e){e.preventDefault();var $notice=$(this).parent(".wpbdp-notice"),dismissible_id=$(this).data("dismissible-id"),nonce=$(this).data("nonce");dismissNotice($notice,dismissible_id,nonce)}).on("click",".wpbdp-notice.is-dismissible > .notice-dismiss",function(e){e.preventDefault();var $notice=$(this).parent(".wpbdp-notice"),dismissible_id=$notice.data("dismissible-id"),nonce=$notice.data("nonce");dismissNotice($notice,dismissible_id,nonce)})})}(jQuery),wpbdpAddonBuild=wpbdpAddons(),jQuery(document).ready(function($){wpbdpAddonBuild.init()}),jQuery(function($){$(".wpbdp-js-toggle").change(function(){var name=$(this).attr("name"),value=$(this).val(),is_checkbox=$(this).is(":checkbox"),is_radio=$(this).is(":radio"),is_select=$(this).is("select"),toggles=$(this).attr("data-toggles");if(is_select){var $option=$(this).find(":selected"),toggles=$option.attr("data-toggles");toggles&&"undefined"!=typeof toggles||(toggles="")}if(toggles){var $dest=$(toggles.startsWith("#")||toggles.startsWith("-")?toggles:"#"+toggles+", ."+toggles);if(0==$dest.length||!is_radio&&!is_checkbox&&!is_select)return;if(is_checkbox&&$(this).is(":checked"))return void $dest.toggleClass("hidden")}if(is_select)var other_opts=$(this).find("option").not('[value="'+value+'"]');else var other_opts=$('input[name="'+name+'"]').not('[value="'+value+'"]');other_opts.each(function(){var toggles_i=$(this).attr("data-toggles");if(toggles_i){var $dest_i=$(toggles_i.startsWith("#")||toggles_i.startsWith("-")?toggles_i:"#"+toggles_i+", ."+toggles_i);$dest_i.addClass("hidden")}}),toggles&&$dest.toggleClass("hidden")})}),jQuery(function($){$(".wpbdp-admin-tab-nav a").click(function(e){e.preventDefault();var $others=$(this).parents("ul").find("li a"),$selected=$others.filter(".current");$others.removeClass("current"),$(this).addClass("current");var href=$(this).attr("href"),$content=$(href);$selected.length>0&&$($selected.attr("href")).hide(),$content.show().focus()}),$(".wpbdp-admin-tab-nav").each(function(i,v){$(this).find("a:first").click()})}),jQuery(function($){$(document).on("click",".wpbdp-admin-confirm",function(e){var message=$(this).data("confirm");message&&"undefined"!=typeof message||(message="Are you sure you want to do this?");var confirm=window.confirm(message);return!!confirm||(e.stopImmediatePropagation(),!1)})});